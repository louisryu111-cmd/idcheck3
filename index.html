<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Banyan Tree Busan Concierge</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8E7958;
            --bg-color: #121212;
            --card-bg: #1E1E1E;
            --text-color: #FFFFFF;
        }

        body {
            margin: 0; padding: 0; background-color: #000;
            font-family: 'Noto Sans KR', sans-serif;
            -webkit-tap-highlight-color: transparent;
            color: var(--text-color);
        }

        #app-container {
            max-width: 480px; margin: 0 auto; background-color: var(--bg-color);
            height: 100vh; position: relative; overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- 보안/안면인식 화면 --- */
        #security-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; z-index: 1000; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s ease;
        }
        .camera-container {
            position: relative; width: 220px; height: 220px; border-radius: 50%;
            overflow: hidden; border: 2px solid #333; margin-bottom: 20px;
            background-color: #1a1a1a; display: flex; align-items: center; justify-content: center;
        }
        #video-feed { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); display: none; }
        .scan-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 5px;
            background-color: var(--primary-color); box-shadow: 0 0 10px var(--primary-color);
            animation: scan 2s infinite linear; display: none;
        }
        @keyframes scan { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        .start-btn {
            background-color: var(--primary-color); color: #fff; border: none;
            padding: 12px 30px; border-radius: 25px; font-size: 16px; font-weight: bold; cursor: pointer;
        }
        .data-warning { font-size: 11px; color: #888; margin-top: 20px; text-align: center; }

        /* --- 메인 화면 --- */
        #main-app { display: none; flex: 1; flex-direction: column; padding: 25px 20px; overflow-y: auto; padding-bottom: 100px; }
        header { margin-bottom: 20px; }
        .hotel-name { font-size: 18px; font-weight: bold; color: var(--primary-color); }
        .welcome-text { font-size: 20px; margin: 20px 0; line-height: 1.4; }

        .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }

        /* 발렛 출차 요청 메뉴 (얇은 가로형) */
        .valet-item {
            grid-column: span 2; background: linear-gradient(135deg, #2c251a, #1a1a1a);
            border: 1px solid var(--primary-color); height: 60px;
            display: flex; align-items: center; padding: 0 20px; border-radius: 12px; cursor: pointer;
        }
        .valet-item i { color: var(--primary-color); margin-right: 15px; font-size: 24px; }
        .valet-item span { font-weight: bold; font-size: 15px; }

        .menu-item {
            background-color: var(--card-bg); border-radius: 12px; height: 90px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .menu-item i { font-size: 28px; color: var(--primary-color); margin-bottom: 8px; }
        .menu-item span { font-size: 13px; color: #eee; }

        /* --- 하단 네비게이션 --- */
        .bottom-nav {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background-color: #1a1a1a; display: flex; justify-content: space-around;
            padding: 15px 0 25px 0; border-top: 1px solid #333; z-index: 50;
        }
        .nav-item { color: var(--primary-color); text-align: center; font-size: 12px; cursor: pointer; flex: 1; }
        .nav-item i { display: block; font-size: 26px; margin-bottom: 4px; }

        /* --- 바텀 시트 (서브메뉴) --- */
        #bottom-sheet-overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; }
        #bottom-sheet {
            position: absolute; bottom: -100%; left: 0; width: 100%; background-color: #1a1a1a;
            border-radius: 20px 20px 0 0; z-index: 101; transition: bottom 0.3s ease;
        }
        .sheet-header { padding: 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        .sheet-content { padding: 10px 20px 30px 20px; }
        .sub-item { padding: 18px 0; border-bottom: 1px solid #2a2a2a; display: flex; justify-content: space-between; color: #ddd; cursor: pointer; }
    </style>
</head>
<body>

<div id="app-container">
    <div id="security-screen">
        <div class="logo-intro">BANYAN TREE<br><span style="font-size:14px; color:#aaa;">BUSAN HAEUNDAE</span></div>
        <div class="camera-container">
            <i class="material-icons" id="camera-icon" style="font-size:60px; color:#555;">face</i>
            <video id="video-feed" playsinline muted></video>
            <div class="scan-line" id="scan-line"></div>
        </div>
        <button class="start-btn" onclick="startCamera()">안면인식 시작</button>
        <div class="data-warning">해당 서비스는 모바일 데이터가 사용될 수 있습니다.</div>
    </div>

    <div id="main-app">
        <header><div class="hotel-name">Banyantree Busan Haeundae</div></header>
        <div class="welcome-text">반갑습니다, 회원님.<br><span style="color:var(--primary-color); font-weight: bold;">무엇을 도와드릴까요?</span></div>

        <div class="menu-grid">
            <div class="valet-item" onclick="handleValetRequest()">
                <i class="material-icons">directions_car</i>
                <span>Valet Parking Request</span>
            </div>
            
            <div class="menu-item" onclick="openSubMenu('concierge')"><i class="material-icons">luggage</i><span>Concierge</span></div>
            <div class="menu-item" onclick="openSubMenu('dining')"><i class="material-icons">restaurant</i><span>Dining</span></div>
            <div class="menu-item" onclick="openSubMenu('lounge')"><i class="material-icons">wine_bar</i><span>Lounge</span></div>
            <div class="menu-item" onclick="openSubMenu('wellness')"><i class="material-icons">spa</i><span>Wellness</span></div>
            <div class="menu-item" onclick="openSubMenu('facilities')"><i class="material-icons">domain</i><span>Facilities</span></div>
            <div class="menu-item" onclick="window.open('https://www.banyantree.com/booking', '_blank')"><i class="material-icons">event_available</i><span>Member booking</span></div>
        </div>
    </div>

    <div id="bottom-sheet-overlay" onclick="closeSubMenu()"></div>
    <div id="bottom-sheet">
        <div class="sheet-header"><span id="sheet-title" style="font-weight:bold; color:var(--primary-color);">Menu</span><i class="material-icons" onclick="closeSubMenu()">close</i></div>
        <div class="sheet-content" id="sheet-content"></div>
    </div>

    <div class="bottom-nav" id="bottom-nav" style="display:none;">
        <div class="nav-item"><i class="material-icons">home</i>Home</div>
        <div class="nav-item" onclick="window.open('https://drive.google.com/file/d/1ICKC21t37n6B5ek9WQc_NNsLAfjAFfMo/view?usp=drive_link', '_blank')">
            <i class="material-icons">map</i>MAP
        </div>
    </div>
</div>

<script>
    // 반얀트리 부산 해운대 좌표 (예시: 오시리아 인근)
    const HOTEL_LAT = 35.195; 
    const HOTEL_LNG = 129.231;

    const SUB_MENU_DATA = {
        concierge: {
            title: "Concierge (관광 안내)",
            items: [
                { name: "봄 (Spring)", url: "https://drive.google.com/file/d/1Ax4O2b49CM5I6-KnMebXjz9r8PHlgUmz/view?usp=drive_link" },
                { name: "여름 (Summer)", url: "https://drive.google.com/file/d/1m1nqU2eRtS4YHKAPKqYEekQn7KF0i_sp/view?usp=drive_link" },
                { name: "가을 (Autumn)", url: "https://drive.google.com/file/d/1d84lGgWJuSJUh3F-AJThTIq-B-t9usRd/view?usp=drive_link" },
                { name: "겨울 (Winter)", url: "https://drive.google.com/file/d/1YpcJG6XhzOfaR_e0iDOY0y2yXt5f0t8S/view?usp=drive_link" }
            ]
        },
        dining: { title: "Dining", items: [ { name: "올리아", url: "#" }, { name: "씨푸드 마켓", url: "#" }, { name: "사프론", url: "#" }, { name: "버티고", url: "#" } ] },
        lounge: { title: "Lounge", items: [ { name: "버티고 바", url: "#" }, { name: "로비 라운지", url: "#" }, { name: "리아스 풀 바", url: "#" }, { name: "크러스트", url: "#" } ] },
        wellness: { title: "Wellness", items: [ { name: "실내 수영장", url: "#" }, { name: "리아스 풀", url: "#" }, { name: "반얀트리 스파", url: "#" }, { name: "피트니스 클럽", url: "#" } ] },
        facilities: { title: "Facilities", items: [ { name: "그랜드 볼룸", url: "#" }, { name: "더 채플", url: "#" }, { name: "레인저스 클럽", url: "#" } ] }
    };

    function startCamera() {
        const video = document.getElementById('video-feed');
        navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } }).then(stream => {
            video.srcObject = stream;
            video.style.display = 'block'; document.getElementById('camera-icon').style.display = 'none';
            document.getElementById('scan-line').style.display = 'block';
            video.play();
            setTimeout(unlockApp, 2500);
        }).catch(() => unlockApp());
    }

    function unlockApp() {
        document.getElementById('security-screen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('security-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'flex';
            document.getElementById('bottom-nav').style.display = 'flex';
        }, 500);
    }

    function handleValetRequest() {
        if (!navigator.geolocation) {
            alert("위치 정보를 사용할 수 없는 기기입니다.");
            return;
        }

        navigator.geolocation.getCurrentPosition((pos) => {
            const dist = Math.sqrt(Math.pow(pos.coords.latitude - HOTEL_LAT, 2) + Math.pow(pos.coords.longitude - HOTEL_LNG, 2));
            
            // 대략적인 거리 체크 (0.005도는 약 500m)
            if (dist < 0.005) {
                const carNum = prompt("출차하실 차량 번호를 입력해주세요.");
                if (carNum) {
                    const msg = encodeURIComponent(`[발렛 출차 요청] 차량번호: ${carNum}`);
                    window.open(`https://wa.me/+821050280073?text=${msg}`, '_blank');
                }
            } else {
                alert("본 서비스는 발렛 출차만 가능하며, 귀하의 위치가 반얀트리 부산 해운대 호텔 내에 계실 때 서비스가 진행됩니다.");
            }
        }, () => {
            alert("위치 권한이 필요합니다.");
        });
    }

    function openSubMenu(cat) {
        const data = SUB_MENU_DATA[cat];
        document.getElementById('sheet-title').innerText = data.title;
        const content = document.getElementById('sheet-content');
        content.innerHTML = '';
        data.items.forEach(item => {
            const div = document.createElement('div');
            div.className = 'sub-item';
            div.innerHTML = `<span>${item.name}</span><i class="material-icons">chevron_right</i>`;
            div.onclick = () => window.open(item.url, '_blank');
            content.appendChild(div);
        });
        document.getElementById('bottom-sheet-overlay').style.display = 'block';
        setTimeout(() => document.getElementById('bottom-sheet').style.bottom = '0', 10);
    }

    function closeSubMenu() {
        document.getElementById('bottom-sheet').style.bottom = '-100%';
        setTimeout(() => document.getElementById('bottom-sheet-overlay').style.display = 'none', 300);
    }
</script>
</body>
</html>